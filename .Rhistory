lai = mean(lai),
ba = mean(ba),
dbh = mean(dbh),
nTrs = mean(nTrs)
), by = .(species)][order(ba,decreasing = T)]
species_dt
p_species <- species_dt$species[1:10]
p_dat <- out1[, .(
lai = mean(lai),
ba = mean(ba),
dbh = mean(dbh),
nTrs = mean(nTrs)
), by = .(t, species)]
p_dat_allSP <- p_dat[, .(
lai = sum(lai),
ba = sum(ba),
dbh = mean(dbh),
nTrs = sum(nTrs),
species = "all"
), by = .(t)]
p_dat <- melt(p_dat, id.vars = c("t", "species"))
p_dat_allSP <- melt(p_dat_allSP, id.vars = c("t", "species"))
ggplot(
p_dat[species %in% p_species], aes(x = t, y = value))+
geom_line(aes(color = factor(species)))+
geom_line(data = p_dat_allSP, linetype = 2)+
facet_wrap(~variable, scales = "free_y")
parsModel <- list(
timesteps = 1000,
sampleSteps = 1,
outVars = c("spID", "lai", "nTrs", "dbh", "ba"),
# actualSpecies = c(0,2, 13,1,17,5),
actualSpecies = selected_species_pars$spID,
baseReg = 200/0.01,
baseRegP = 0.1,
bgMort = 2.3,
distP = 0.00,
env = 0.4,
# env = 0.7,
patchesN = 100,
areaHectar = 0.01,
heightClassesN = 10,
initPop = NULL,
# initPop = cohortsIN,
speciesPars = selected_species_pars
)
system.time(
outMat1 <- runModel(pars = parsModel, speciesPars = selected_species_pars)
)
outDT <- data.table(outMat1)
names(outDT) <- c(parsModel$outVars,"t","p")
out1 <- outDT
out1 <- merge(out1, selected_species_pars[,c("spID","species")], by = "spID")
species_dt <-
out1[, .(
lai = mean(lai),
ba = mean(ba),
dbh = mean(dbh),
nTrs = mean(nTrs)
), by = .(species)][order(ba,decreasing = T)]
species_dt
p_species <- species_dt$species[1:10]
p_dat <- out1[, .(
lai = mean(lai),
ba = mean(ba),
dbh = mean(dbh),
nTrs = mean(nTrs)
), by = .(t, species)]
p_dat_allSP <- p_dat[, .(
lai = sum(lai),
ba = sum(ba),
dbh = mean(dbh),
nTrs = sum(nTrs),
species = "all"
), by = .(t)]
p_dat <- melt(p_dat, id.vars = c("t", "species"))
p_dat_allSP <- melt(p_dat_allSP, id.vars = c("t", "species"))
ggplot(
p_dat[species %in% p_species], aes(x = t, y = value))+
geom_line(aes(color = factor(species)))+
geom_line(data = p_dat_allSP, linetype = 2)+
facet_wrap(~variable, scales = "free_y")
source("~/working-directory/demrate-inference/R/run_ForDem.R")
names(outDT) <- c(parsModel$outVars,"t","p")
out1 <- outDT
out1 <- merge(out1, selected_species_pars[,c("spID","species")], by = "spID")
p_dat <- out1[, .(
lai = mean(lai),
ba = mean(ba),
dbh = mean(dbh),
nTrs = mean(nTrs)
), by = .(t, species)]
p_dat_allSP <- p_dat[, .(
lai = sum(lai),
ba = sum(ba),
dbh = mean(dbh),
nTrs = sum(nTrs),
species = "all"
), by = .(t)]
p_dat <- melt(p_dat, id.vars = c("t", "species"))
p_dat_allSP <- melt(p_dat_allSP, id.vars = c("t", "species"))
ggplot(
p_dat[species %in% p_species], aes(x = t, y = value))+
geom_line(aes(color = factor(species)))+
geom_line(data = p_dat_allSP, linetype = 2)+
facet_wrap(~variable, scales = "free_y")
selected_species_pars[, env := scale(-kDrTol)*scale(kDDMin), ]
selected_species_pars[, env := env+abs(min(env)), ]
selected_species_pars[, env := env/max(env), ]
sourceCpp("library/fordem.cpp")
parsModel <- list(
timesteps = 1000,
sampleSteps = 1,
outVars = c("spID", "lai", "nTrs", "dbh", "ba"),
actualSpecies = c(0,2, 13,1,17,5),
# actualSpecies = selected_species_pars$spID,
baseReg = 200/0.01,
baseRegP = 0.1,
bgMort = 2.3,
distP = 0.00,
env = 0.4,
# env = 0.7,
patchesN = 100,
areaHectar = 0.01,
heightClassesN = 10,
initPop = NULL,
# initPop = cohortsIN,
speciesPars = selected_species_pars
)
system.time(
outMat1 <- runModel(pars = parsModel, speciesPars = selected_species_pars)
)
outDT <- data.table(outMat1)
names(outDT) <- c(parsModel$outVars,"t","p")
out1 <- outDT
out1 <- merge(out1, selected_species_pars[,c("spID","species")], by = "spID")
p_dat <- out1[, .(
lai = mean(lai),
ba = mean(ba),
dbh = mean(dbh),
nTrs = mean(nTrs)
), by = .(t, species)]
p_dat_allSP <- p_dat[, .(
lai = sum(lai),
ba = sum(ba),
dbh = mean(dbh),
nTrs = sum(nTrs),
species = "all"
), by = .(t)]
p_dat <- melt(p_dat, id.vars = c("t", "species"))
p_dat_allSP <- melt(p_dat_allSP, id.vars = c("t", "species"))
ggplot(
p_dat[species %in% p_species], aes(x = t, y = value))+
geom_line(aes(color = factor(species)))+
geom_line(data = p_dat_allSP, linetype = 2)+
facet_wrap(~variable, scales = "free_y")
selected_species_pars
selected_species_pars <- data.table(selected_species_pars)
selected_species_pars[, env := scale(kDDMin), ]
selected_species_pars[, env := scale(-kDrTol), ]
selected_species_pars[, env := scale(-kDrTol)*scale(kDDMin), ]
selected_species_pars[, env := env+abs(min(env)), ]
selected_species_pars[, env := env/max(env), ]
sourceCpp("library/fordem.cpp")
parsModel <- list(
timesteps = 1000,
sampleSteps = 1,
outVars = c("spID", "lai", "nTrs", "dbh", "ba"),
actualSpecies = c(0,2, 13,1,17,5),
# actualSpecies = selected_species_pars$spID,
baseReg = 200/0.01,
baseRegP = 0.1,
bgMort = 2.3,
distP = 0.00,
env = 0.4,
# env = 0.7,
patchesN = 100,
areaHectar = 0.01,
heightClassesN = 10,
initPop = NULL,
# initPop = cohortsIN,
speciesPars = selected_species_pars
)
system.time(
outMat1 <- runModel(pars = parsModel, speciesPars = selected_species_pars)
)
outDT <- data.table(outMat1)
names(outDT) <- c(parsModel$outVars,"t","p")
out1 <- outDT
out1 <- merge(out1, selected_species_pars[,c("spID","species")], by = "spID")
p_dat <- out1[, .(
lai = mean(lai),
ba = mean(ba),
dbh = mean(dbh),
nTrs = mean(nTrs)
), by = .(t, species)]
p_dat_allSP <- p_dat[, .(
lai = sum(lai),
ba = sum(ba),
dbh = mean(dbh),
nTrs = sum(nTrs),
species = "all"
), by = .(t)]
p_dat <- melt(p_dat, id.vars = c("t", "species"))
p_dat_allSP <- melt(p_dat_allSP, id.vars = c("t", "species"))
ggplot(
p_dat[species %in% p_species], aes(x = t, y = value))+
geom_line(aes(color = factor(species)))+
geom_line(data = p_dat_allSP, linetype = 2)+
facet_wrap(~variable, scales = "free_y")
selected_species_pars[, env := scale(kDDMin), ]
selected_species_pars[, env := scale(-kDrTol), ]
# selected_species_pars[, env := scale(-kDrTol)*scale(kDDMin), ]
selected_species_pars[, env := env+abs(min(env)), ]
selected_species_pars[, env := env/max(env), ]
selected_species_pars
sourceCpp("library/fordem.cpp")
parsModel <- list(
timesteps = 1000,
sampleSteps = 1,
outVars = c("spID", "lai", "nTrs", "dbh", "ba"),
actualSpecies = c(0,2, 13,1,17,5),
# actualSpecies = selected_species_pars$spID,
baseReg = 200/0.01,
baseRegP = 0.1,
bgMort = 2.3,
distP = 0.00,
env = 0.4,
# env = 0.7,
patchesN = 100,
areaHectar = 0.01,
heightClassesN = 10,
initPop = NULL,
# initPop = cohortsIN,
speciesPars = selected_species_pars
)
system.time(
outMat1 <- runModel(pars = parsModel, speciesPars = selected_species_pars)
)
outDT <- data.table(outMat1)
names(outDT) <- c(parsModel$outVars,"t","p")
out1 <- outDT
out1 <- merge(out1, selected_species_pars[,c("spID","species")], by = "spID")
p_dat <- out1[, .(
lai = mean(lai),
ba = mean(ba),
dbh = mean(dbh),
nTrs = mean(nTrs)
), by = .(t, species)]
p_dat_allSP <- p_dat[, .(
lai = sum(lai),
ba = sum(ba),
dbh = mean(dbh),
nTrs = sum(nTrs),
species = "all"
), by = .(t)]
p_dat <- melt(p_dat, id.vars = c("t", "species"))
p_dat_allSP <- melt(p_dat_allSP, id.vars = c("t", "species"))
ggplot(
p_dat[species %in% p_species], aes(x = t, y = value))+
geom_line(aes(color = factor(species)))+
geom_line(data = p_dat_allSP, linetype = 2)+
facet_wrap(~variable, scales = "free_y")
p_species
ggplot(
p_dat, aes(x = t, y = value))+
geom_line(aes(color = factor(species)))+
geom_line(data = p_dat_allSP, linetype = 2)+
facet_wrap(~variable, scales = "free_y")
selected_species_pars[, env := scale(-kDrTol)*scale(kDDMin), ]
selected_species_pars[, env := env+abs(min(env)), ]
selected_species_pars[, env := env/max(env), ]
sourceCpp("library/fordem.cpp")
parsModel <- list(
timesteps = 1000,
sampleSteps = 1,
outVars = c("spID", "lai", "nTrs", "dbh", "ba"),
actualSpecies = c(0,2,13,1,17,5),
# actualSpecies = selected_species_pars$spID,
baseReg = 200/0.01,
baseRegP = 0.1,
bgMort = 2.3,
distP = 0.00,
env = 0.4,
# env = 0.7,
patchesN = 100,
areaHectar = 0.01,
heightClassesN = 10,
initPop = NULL,
# initPop = cohortsIN,
speciesPars = selected_species_pars
)
system.time(
outMat1 <- runModel(pars = parsModel, speciesPars = selected_species_pars)
)
outDT <- data.table(outMat1)
names(outDT) <- c(parsModel$outVars,"t","p")
out1 <- outDT
out1 <- merge(out1, selected_species_pars[,c("spID","species")], by = "spID")
p_dat <- out1[, .(
lai = mean(lai),
ba = mean(ba),
dbh = mean(dbh),
nTrs = mean(nTrs)
), by = .(t, species)]
p_dat_allSP <- p_dat[, .(
lai = sum(lai),
ba = sum(ba),
dbh = mean(dbh),
nTrs = sum(nTrs),
species = "all"
), by = .(t)]
p_dat <- melt(p_dat, id.vars = c("t", "species"))
p_dat_allSP <- melt(p_dat_allSP, id.vars = c("t", "species"))
ggplot(
p_dat, aes(x = t, y = value))+
geom_line(aes(color = factor(species)))+
geom_line(data = p_dat_allSP, linetype = 2)+
facet_wrap(~variable, scales = "free_y")
outMat1
parsModel <- list(
timesteps = 500,
sampleSteps = 1,
outVars = c("spID", "lai", "nTrs", "dbh", "ba"),
actualSpecies = c(0,2,13,1,17,5),
# actualSpecies = selected_species_pars$spID,
baseReg = 200/0.01,
baseRegP = 0.1,
bgMort = 2.3,
distP = 0.00,
env = 0.4,
# env = 0.7,
patchesN = 200,
areaHectar = 0.01,
heightClassesN = 10,
initPop = NULL,
# initPop = cohortsIN,
speciesPars = selected_species_pars
)
system.time(
outMat1 <- runModel(pars = parsModel, speciesPars = selected_species_pars)
)
outDT <- data.table(outMat1)
names(outDT) <- c(parsModel$outVars,"t","p")
out1 <- outDT
out1 <- merge(out1, selected_species_pars[,c("spID","species")], by = "spID")
p_dat <- out1[, .(
lai = mean(lai),
ba = mean(ba),
dbh = mean(dbh),
nTrs = mean(nTrs)
), by = .(t, species)]
p_dat_allSP <- p_dat[, .(
lai = sum(lai),
ba = sum(ba),
dbh = mean(dbh),
nTrs = sum(nTrs),
species = "all"
), by = .(t)]
p_dat <- melt(p_dat, id.vars = c("t", "species"))
p_dat_allSP <- melt(p_dat_allSP, id.vars = c("t", "species"))
ggplot(
p_dat, aes(x = t, y = value))+
geom_line(aes(color = factor(species)))+
geom_line(data = p_dat_allSP, linetype = 2)+
facet_wrap(~variable, scales = "free_y")
parsModel <- list(
timesteps = 500,
sampleSteps = 1,
outVars = c("spID", "lai", "nTrs", "dbh", "ba"),
actualSpecies = c(0,2,13,1,17,5),
# actualSpecies = selected_species_pars$spID,
baseReg = 200/0.01,
baseRegP = 0.1,
bgMort = 2.3,
distP = 0.00,
env = 0.4,
# env = 0.7,
patchesN = 1,
areaHectar = 0.01,
heightClassesN = 10,
initPop = NULL,
# initPop = cohortsIN,
speciesPars = selected_species_pars
)
system.time(
outMat1 <- runModel(pars = parsModel, speciesPars = selected_species_pars)
)
outDT <- data.table(outMat1)
names(outDT) <- c(parsModel$outVars,"t","p")
out1 <- outDT
out1 <- merge(out1, selected_species_pars[,c("spID","species")], by = "spID")
p_dat <- out1[, .(
lai = mean(lai),
ba = mean(ba),
dbh = mean(dbh),
nTrs = mean(nTrs)
), by = .(t, species)]
p_dat_allSP <- p_dat[, .(
lai = sum(lai),
ba = sum(ba),
dbh = mean(dbh),
nTrs = sum(nTrs),
species = "all"
), by = .(t)]
p_dat <- melt(p_dat, id.vars = c("t", "species"))
p_dat_allSP <- melt(p_dat_allSP, id.vars = c("t", "species"))
ggplot(
p_dat, aes(x = t, y = value))+
geom_line(aes(color = factor(species)))+
geom_line(data = p_dat_allSP, linetype = 2)+
facet_wrap(~variable, scales = "free_y")
parsModel <- list(
timesteps = 500,
sampleSteps = 1,
outVars = c("spID", "lai", "nTrs", "dbh", "ba"),
actualSpecies = c(0,2,13,1,17,5),
# actualSpecies = selected_species_pars$spID,
baseReg = 200/0.01,
baseRegP = 0.1,
bgMort = 2.3,
distP = 0.00,
env = 0.4,
# env = 0.7,
patchesN = 200,
areaHectar = 0.01,
heightClassesN = 10,
initPop = NULL,
# initPop = cohortsIN,
speciesPars = selected_species_pars
)
system.time(
outMat1 <- runModel(pars = parsModel, speciesPars = selected_species_pars)
)
outDT <- data.table(outMat1)
names(outDT) <- c(parsModel$outVars,"t","p")
out1 <- outDT
out1 <- merge(out1, selected_species_pars[,c("spID","species")], by = "spID")
p_dat <- out1[, .(
lai = mean(lai),
ba = mean(ba),
dbh = mean(dbh),
nTrs = mean(nTrs)
), by = .(t, species)]
p_dat_allSP <- p_dat[, .(
lai = sum(lai),
ba = sum(ba),
dbh = mean(dbh),
nTrs = sum(nTrs),
species = "all"
), by = .(t)]
p_dat <- melt(p_dat, id.vars = c("t", "species"))
p_dat_allSP <- melt(p_dat_allSP, id.vars = c("t", "species"))
ggplot(
p_dat, aes(x = t, y = value))+
geom_line(aes(color = factor(species)))+
geom_line(data = p_dat_allSP, linetype = 2)+
facet_wrap(~variable, scales = "free_y")
sourceCpp("library/fordem.cpp")
selected_species_pars <- data.table(selected_species_pars)
selected_species_pars[, env := scale(kDDMin), ]
selected_species_pars[, env := scale(-kDrTol), ]
selected_species_pars[, env := scale(-kDrTol)*scale(kDDMin), ]
selected_species_pars[, env := env+abs(min(env)), ]
selected_species_pars[, env := env/max(env), ]
sourceCpp("library/fordem.cpp")
parsModel <- list(
timesteps = 500,
sampleSteps = 1,
outVars = c("spID", "lai", "nTrs", "dbh", "ba"),
actualSpecies = c(0,2,13,1,17,5),
# actualSpecies = selected_species_pars$spID,
baseReg = 200/0.01,
baseRegP = 0.1,
bgMort = 2.3,
distP = 0.00,
env = 0.4,
# env = 0.7,
patchesN = 200,
areaHectar = 0.01,
heightClassesN = 10,
initPop = NULL,
# initPop = cohortsIN,
speciesPars = selected_species_pars
)
system.time(
outMat1 <- runModel(pars = parsModel, speciesPars = selected_species_pars)
)
outDT <- data.table(outMat1)
names(outDT) <- c(parsModel$outVars,"t","p")
out1 <- outDT
out1 <- merge(out1, selected_species_pars[,c("spID","species")], by = "spID")
p_dat <- out1[, .(
lai = mean(lai),
ba = mean(ba),
dbh = mean(dbh),
nTrs = mean(nTrs)
), by = .(t, species)]
p_dat_allSP <- p_dat[, .(
lai = sum(lai),
ba = sum(ba),
dbh = mean(dbh),
nTrs = sum(nTrs),
species = "all"
), by = .(t)]
p_dat <- melt(p_dat, id.vars = c("t", "species"))
p_dat_allSP <- melt(p_dat_allSP, id.vars = c("t", "species"))
ggplot(
p_dat, aes(x = t, y = value))+
geom_line(aes(color = factor(species)))+
geom_line(data = p_dat_allSP, linetype = 2)+
facet_wrap(~variable, scales = "free_y")
